# Generated with protoc-gen-openapi
# https://github.com/google/gnostic/tree/master/cmd/protoc-gen-openapi

openapi: 3.0.3
info:
  title: BaseService API
  description: |-
    @securityDefinitions.apikey BearerAuth
     @in header
     @name Authorization
  version: 0.0.1
paths:
  /v1/channel:
    get:
      tags:
        - BaseService
      description: 按照id查询频道完整信息
      operationId: BaseService_ChannelGet
      parameters:
        - name: channel_id
          in: query
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelGetRes'
    put:
      tags:
        - BaseService
      description: 更新频道
      operationId: BaseService_ChannelUpdate
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChannelUpdateReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelUpdateRes'
    post:
      tags:
        - BaseService
      description: 创建频道
      operationId: BaseService_ChannelCreate
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChannelCreateReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelCreateRes'
    delete:
      tags:
        - BaseService
      description: 删除频道
      operationId: BaseService_ChannelDelete
      parameters:
        - name: channel_id
          in: query
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelDeleteRes'
  /v1/channel/query_by_location_bound:
    get:
      tags:
        - BaseService
      description: 按照地理范围查询频道
      operationId: BaseService_ChannelQueryByLocationBound
      parameters:
        - name: bound.sw.lat
          in: query
          schema:
            type: number
            format: float
        - name: bound.sw.lng
          in: query
          schema:
            type: number
            format: float
        - name: bound.ne.lat
          in: query
          schema:
            type: number
            format: float
        - name: bound.ne.lng
          in: query
          schema:
            type: number
            format: float
        - name: marker_ids
          in: query
          description: 足迹类型id列表
          schema:
            type: array
            items:
              type: integer
              format: int32
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelQueryByLocationBoundRes'
  /v1/channel/query_by_user:
    get:
      tags:
        - BaseService
      description: 按照用户互动记录查询频道列表
      operationId: BaseService_ChannelQueryByUser
      parameters:
        - name: user_id
          in: query
          schema:
            type: string
        - name: ixn_state
          in: query
          description: 互动状态类型, 二选一
          schema:
            type: integer
            format: enum
        - name: ixn_event
          in: query
          description: 互动时间类型, 二选一
          schema:
            type: integer
            format: enum
        - name: ext_types
          in: query
          description: 类型
          schema:
            type: array
            items:
              type: integer
              format: enum
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelQueryByUserRes'
  /v1/location/search:
    get:
      tags:
        - BaseService
      description: 通用地点搜索
      operationId: BaseService_LocationCommonSearch
      parameters:
        - name: input
          in: query
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocationCommonSearchRes'
  /v1/media/put_url/batch:
    get:
      tags:
        - BaseService
      description: 批量获取对象上传预签名URL
      operationId: BaseService_MediaPutURLBatchGet
      parameters:
        - name: bucket
          in: query
          schema:
            type: integer
            format: enum
        - name: count
          in: query
          schema:
            type: integer
            format: int32
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MediaPutURLBatchGetRes'
  /v1/pet/marker:
    get:
      tags:
        - BaseService
      description: 查询狗狗标记类型
      operationId: BaseService_PetMarkerInfoList
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PetMarkerInfoRes'
  /v1/post:
    put:
      tags:
        - BaseService
      description: 帖子更新
      operationId: BaseService_PostUpdate
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostUpdateReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostUpdateRes'
    post:
      tags:
        - BaseService
      description: 帖子创建
      operationId: BaseService_PostCreate
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostCreateReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostCreateRes'
    delete:
      tags:
        - BaseService
      description: 帖子删除
      operationId: BaseService_PostDelete
      parameters:
        - name: channel_id
          in: query
          schema:
            type: string
        - name: post_id
          in: query
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostDeleteRes'
  /v1/post/load:
    get:
      tags:
        - BaseService
      description: 频道帖子加载
      operationId: BaseService_PostLoad
      parameters:
        - name: channel_id
          in: query
          schema:
            type: string
        - name: limit
          in: query
          schema:
            type: integer
            format: int32
        - name: last_post_id
          in: query
          description: 从传空加载最新100条
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostLoadRes'
  /v1/post/query:
    get:
      tags:
        - BaseService
      description: 频道帖子复合查询
      operationId: BaseService_PostQuery
      parameters:
        - name: channel_id
          in: query
          schema:
            type: string
        - name: limit
          in: query
          schema:
            type: integer
            format: int32
        - name: marker_id
          in: query
          schema:
            type: integer
            format: int32
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostQueryRes'
  /v1/post/query_by_user:
    get:
      tags:
        - BaseService
      description: 按照用户互动记录查询帖子列表
      operationId: BaseService_PostQueryByUser
      parameters:
        - name: user_id
          in: query
          schema:
            type: string
        - name: ixn_state
          in: query
          description: 互动状态类型, 二选一
          schema:
            type: integer
            format: enum
        - name: ixn_event
          in: query
          description: 互动时间类型, 二选一
          schema:
            type: integer
            format: enum
        - name: ext_types
          in: query
          description: 类型
          schema:
            type: array
            items:
              type: integer
              format: enum
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostQueryByUserRes'
  /v1/post/react:
    post:
      tags:
        - BaseService
      description: 频道帖子回应
      operationId: BaseService_PostReact
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostReactReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostReactRes'
  /v1/system/notify:
    get:
      tags:
        - BaseService
      description: 查询系统通知接口
      operationId: BaseService_SystemNotifyGet
      parameters:
        - name: last_notify_id
          in: query
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemNotifyGetRes'
  /v1/user/fast_reg/wx:
    post:
      tags:
        - BaseService
      description: 微信小程序快速登录注册接口定义
      operationId: BaseService_FastRegisterWeChat
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FastRegisterWeChatReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FastRegisterWeChatRes'
  /v1/user/inx:
    post:
      tags:
        - BaseService
      description: 用户互动
      operationId: BaseService_UserInx
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserInxReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInxRes'
  /v1/user/login/wx:
    post:
      tags:
        - BaseService
      description: |-
        微信小程序登录接口
         @security BearerAuth
      operationId: BaseService_LoginWeChat
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginWeChatReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginWeChatRes'
  /v1/user/pet:
    get:
      tags:
        - BaseService
      description: 宠物资料查询
      operationId: BaseService_UserPeGet
      parameters:
        - name: user_id
          in: query
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPeGetRes'
    put:
      tags:
        - BaseService
      description: 宠物资料更新
      operationId: BaseService_UserPetUpdate
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPetUpdateReq'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPetUpdateRes'
components:
  schemas:
    ChannelCreateReq:
      type: object
      properties:
        channel:
          $ref: '#/components/schemas/ChannelInfo'
      description: 创建频道
    ChannelCreateRes:
      type: object
      properties:
        channel:
          $ref: '#/components/schemas/ChannelInfo'
    ChannelDeleteRes:
      type: object
      properties: {}
    ChannelExtGroup:
      type: object
      properties:
        title:
          type: string
          description: 频道名称标题
        intro:
          type: string
          description: 简介, 可更新
        avatar:
          allOf:
            - $ref: '#/components/schemas/MediaInfo'
          description: 频道头像
      description: 频道群组拓展
    ChannelExtLocation:
      type: object
      properties:
        stats:
          $ref: '#/components/schemas/ChannelExtLocationStats'
        name:
          type: string
          description: 地点名字
        address:
          type: string
          description: POI 地址, 不可更新
        coord:
          allOf:
            - $ref: '#/components/schemas/PointCoord'
          description: 足迹位置, 不可更新
      description: 频道地点拓展
    ChannelExtLocationStats:
      type: object
      properties:
        marker_ids:
          type: array
          items:
            type: integer
            format: int32
          description: 出现过的标记id
        marks_cnt:
          type: integer
          description: 足迹数量
          format: int32
        last_mark_at:
          type: string
          description: 最新足迹时间
        pets_cnt:
          type: integer
          description: 来过的狗狗数量
          format: int32
    ChannelGetRes:
      type: object
      properties:
        channel:
          $ref: '#/components/schemas/ChannelInfo'
    ChannelInfo:
      type: object
      properties:
        id:
          type: string
          description: 频道 ID
        uid:
          type: string
          description: 频道创建者
        ext_type:
          type: integer
          description: 频道拓展类型
          format: enum
        stats:
          allOf:
            - $ref: '#/components/schemas/ChannelStats'
          description: 状态信息，只读
        group_ext:
          allOf:
            - $ref: '#/components/schemas/ChannelExtGroup'
          description: 群组拓展
        location_ext:
          allOf:
            - $ref: '#/components/schemas/ChannelExtLocation'
          description: 地点拓展
        created_at:
          type: string
        updated_at:
          type: string
      description: 频道信息
    ChannelQueryByLocationBoundRes:
      type: object
      properties:
        channels:
          type: array
          items:
            $ref: '#/components/schemas/ChannelInfo'
    ChannelQueryByUserRes:
      type: object
      properties:
        channels:
          type: array
          items:
            $ref: '#/components/schemas/ChannelInfo'
    ChannelStats:
      type: object
      properties:
        posts_cnt:
          type: integer
          description: 帖子数量
          format: int32
        last_post_at:
          type: string
        stars_cnt:
          type: integer
          description: 收藏数, 收藏代表订阅
          format: int32
        last_star_at:
          type: string
        likes_cnt:
          type: integer
          description: 点赞数, 点赞代表认可
          format: int32
        last_like_at:
          type: string
        views_cnt:
          type: integer
          description: 查看数
          format: int32
        updated_at:
          type: string
      description: 频道状态, 只读
    ChannelUpdateReq:
      type: object
      properties:
        channel:
          $ref: '#/components/schemas/ChannelInfo'
      description: 频道更新
    ChannelUpdateRes:
      type: object
      properties:
        channel:
          $ref: '#/components/schemas/ChannelInfo'
    FastRegisterWeChatReq:
      type: object
      properties:
        reg_data:
          $ref: '#/components/schemas/UserFastRegisterData'
        wx_code:
          type: string
      description: 快速注册请求
    FastRegisterWeChatRes:
      type: object
      properties:
        token:
          type: string
        user:
          $ref: '#/components/schemas/UserInfo'
    LocationCommonSearchRes:
      type: object
      properties: {}
    LoginWeChatReq:
      type: object
      properties:
        wx_code:
          type: string
      description: 登录请求
    LoginWeChatRes:
      type: object
      properties:
        token:
          type: string
        user:
          $ref: '#/components/schemas/UserInfo'
    MediaInfo:
      type: object
      properties:
        bucket:
          type: integer
          description: 位置
          format: enum
        uuid:
          type: string
          description: ID, 可写入
        get_url:
          type: string
          description: 读取URL
        put_url:
          type: string
          description: 写入URL
    MediaPutURLBatchGetRes:
      type: object
      properties:
        media:
          type: array
          items:
            $ref: '#/components/schemas/MediaInfo'
    NotifyInfo:
      type: object
      properties:
        id:
          type: string
          description: 通知id
        content:
          type: string
          description: 正文内容
        created_at:
          type: string
        updated_at:
          type: string
      description: 系统通知
    PetInfo:
      type: object
      properties:
        id:
          type: string
        uid:
          type: string
        status:
          type: integer
          format: int32
        specie:
          type: string
        name:
          type: string
        intro:
          type: string
        gender:
          type: integer
          format: uint32
        birth_date:
          type: string
        avatar:
          $ref: '#/components/schemas/MediaInfo'
        size:
          type: string
        breed:
          type: string
        weight:
          type: integer
          format: int32
        created_at:
          type: string
        updated_at:
          type: string
    PetMarkerInfo:
      type: object
      properties:
        id:
          type: integer
          format: int32
        name:
          type: string
        coverage_radius:
          type: integer
          format: int32
        theme_color:
          type: string
        created_at:
          type: string
        updated_at:
          type: string
      description: 狗狗足迹信息
    PetMarkerInfoRes:
      type: object
      properties:
        pet_marks:
          type: array
          items:
            $ref: '#/components/schemas/PetMarkerInfo'
    PointCoord:
      type: object
      properties:
        lat:
          type: number
          format: float
        lng:
          type: number
          format: float
    PostCreateReq:
      type: object
      properties:
        post:
          $ref: '#/components/schemas/PostInfo'
    PostCreateRes:
      type: object
      properties:
        post:
          $ref: '#/components/schemas/PostInfo'
    PostDeleteRes:
      type: object
      properties: {}
    PostExtPetMarker:
      type: object
      properties:
        marker_ids:
          type: array
          items:
            type: integer
            format: int32
        pids:
          type: array
          items:
            type: string
      description: 足迹拓展
    PostInfo:
      type: object
      properties:
        id:
          type: string
          description: 评论id
        uid:
          type: string
          description: 足迹作者
        channel_id:
          type: string
          description: 频道id
        parent_id:
          type: string
          description: 上级帖子id
        ext_type:
          type: integer
          description: 频道拓展类型
          format: enum
        stats:
          allOf:
            - $ref: '#/components/schemas/PostStats'
          description: 动态状态信息，只读
        content:
          type: string
          description: 正文内容
        media_ids:
          type: array
          items:
            type: string
          description: 媒体id
        ext_pet_mark:
          $ref: '#/components/schemas/PostExtPetMarker'
        created_at:
          type: string
        updated_at:
          type: string
      description: 帖子
    PostLoadRes:
      type: object
      properties:
        posts:
          type: array
          items:
            $ref: '#/components/schemas/PostInfo'
    PostQueryByUserRes:
      type: object
      properties:
        posts:
          type: array
          items:
            $ref: '#/components/schemas/PostInfo'
    PostQueryRes:
      type: object
      properties:
        posts:
          type: array
          items:
            $ref: '#/components/schemas/PostInfo'
    PostReactReq:
      type: object
      properties:
        post_id:
          type: string
        react_id:
          type: string
    PostReactRes:
      type: object
      properties: {}
    PostReaction:
      type: object
      properties:
        id:
          type: string
          description: 反应类型
        count:
          type: integer
          description: 反应数量
          format: int32
        updated_at:
          type: string
    PostSignReaction:
      type: object
      properties:
        id:
          type: string
          description: 反应类型
        count:
          type: integer
          description: 反应数量
          format: int32
        users:
          type: array
          items:
            $ref: '#/components/schemas/UserInfo'
          description: 反应用户信息列表.
        updated_at:
          type: string
    PostStats:
      type: object
      properties:
        stars_cnt:
          type: integer
          description: 收藏数
          format: int32
        last_star_at:
          type: string
        replies_cnt:
          type: integer
          description: 回复数量
          format: int32
        last_reply_at:
          type: string
        reacts:
          type: array
          items:
            $ref: '#/components/schemas/PostReaction'
        sign_reacts:
          type: array
          items:
            $ref: '#/components/schemas/PostSignReaction'
        updated_at:
          type: string
      description: 频道状态, 只读
    PostUpdateReq:
      type: object
      properties:
        post:
          $ref: '#/components/schemas/PostInfo'
    PostUpdateRes:
      type: object
      properties:
        post:
          $ref: '#/components/schemas/PostInfo'
    SystemNotifyGetRes:
      type: object
      properties:
        notifies:
          type: array
          items:
            $ref: '#/components/schemas/NotifyInfo'
    UserFastRegisterData:
      type: object
      properties:
        pet_name:
          type: string
          description: 名字
        pet_avatar_data:
          type: string
          description: 宠物头像 base64 data
        pet_title:
          type: string
          description: 宠物和人的关系
      description: 宠物快速注册信息
    UserInfo:
      type: object
      properties:
        id:
          type: string
        user_pets:
          type: array
          items:
            $ref: '#/components/schemas/UserPetInfo'
        name:
          type: string
        avatar:
          type: string
        created_at:
          type: string
        updated_at:
          type: string
    UserInxReq:
      type: object
      properties:
        channel_id:
          type: string
          description: 互动的频道
        post_id:
          type: string
          description: 互动的帖子，为空则为互动频道
        inx_state:
          type: integer
          description: 互动状态
          format: enum
        inx_state_action:
          type: integer
          description: 是否撤销状态
          format: enum
        inx_event:
          type: integer
          description: 互动事件
          format: enum
    UserInxRes:
      type: object
      properties: {}
    UserPeGetRes:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/UserInfo'
    UserPetInfo:
      type: object
      properties:
        pet:
          $ref: '#/components/schemas/PetInfo'
        pet_title:
          type: string
        pet_status:
          type: integer
          format: int32
    UserPetUpdateReq:
      type: object
      properties:
        user_pet:
          $ref: '#/components/schemas/UserPetInfo'
    UserPetUpdateRes:
      type: object
      properties:
        user_pet:
          $ref: '#/components/schemas/UserPetInfo'
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
tags:
  - name: BaseService
security:
  - bearerAuth: []
